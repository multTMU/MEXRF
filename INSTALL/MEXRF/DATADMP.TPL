$REM
$REM Channel by Channel Data Report Template
$REM
$SEC Data
$NP 50
$REM   $PH "Channel Data Report             |DDDDDDDDD |TTTTTTTTTT            Page |I" #datetime #datetime #pagenum
$REM
$REM INITIALIZE THE DATA CARRIERS
$REM
$SETE #IV1 1
$SETE #IV2 2
$SETE #IV3 3
$SETE #IV4 4
$SETE #IV5 5
$SETE #IV6 6
$SETE #IV7 7
$SETE #IV8 8
""
"         ***********************************************************"
"         ****  BOBS XRF S P E C T R A L  D A T A   R E P O R T  ****"
"         ***********************************************************"
""
"         Information: |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" SDESC1
"         Acq. Start time:  |DDDDDDDD |TTTTTTTT" ASTIME ASTIME
"         Elapsed Live time: |FFFFFF.FF" ELIVE
"         Elapsed Real Time: |FFFFFF.FF" EREAL
"         Sample Vial Temp:  |FFFFFF.FF" STEMP
"         KED Path Length:   |FFFF.FFFF +/- |FFFF.FFFF" kcpathlen dtrescellder
"         KED Concentration (g/L): |FFFF.FFFF +/- |FFFF.FFFF" dtresrconc dtresrconce
"         HV Cutoff (kV):         |FFFF.FFFF" krhvcutoff
"         Pu Atomic weight:       |FFFF.FFFF" PRKEDDPUAWT
"         U enrichment:           |FFFF.FFFF" PRKEDDCL235
"         Energy cal zero:        |FFFF.FFFF" ECOFFSET
"         Energy cal slope:       |FFFF.FFFF" ECSLOPE
"         Channels:              |FFFFF.FFFF" CHANNELS
"         Sample Title:   |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" STITLE
""
"Channel|------|-------|-------|-------|-------|-------|-------|-------|"
$SETE #IV9 48
$BT CHANNELS
$SETS #IV9 1
$REM
$REM IF PAGE LINES ZERO OUT, PRINT BASIC HEADER AT TOP OF PAGE.
$REM
$REM   $IFNOT #IV9
$REM   ""
$REM   "         Sample Title:   |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" STITLE
$REM   ""
$REM   "Channel|------|-------|-------|-------|-------|-------|-------|-------|"
$REM   $SETE #IV9 54
$REM   $ENDIF
"|IIII: |IIIIII |IIIIII |IIIIII |IIIIII |IIIIII |IIIIII |IIIIII |IIIIII" #IV1 SPECDATA(#IV1) SPECDATA(#IV2) SPECDATA(#IV3) SPECDATA(#IV4) SPECDATA(#IV5) SPECDATA(#IV6) SPECDATA(#IV7) SPECDATA(#IV8)
$REM
$REM INCREMENT TO THE NEXT GROUP OF 8 CHANNELS.
$REM
$SETA #IV1 8
$SETA #IV2 8
$SETA #IV3 8
$SETA #IV4 8
$SETA #IV5 8
$SETA #IV6 8
$SETA #IV7 8
$SETA #IV8 8
$ET 8
$REM
$REM
$SEC ROIDATA
$REM
$REM Channel by Channel ROI Data Report Template
$REM
$NP 50
$REM   $PH "ROI Channel Data Report             |DDDDDDD |TTTTTTTTTT              Page |I" #datetime #datetime #pagenum
$REM
$REM GET NUMBER OF ROI'S (FV1)
$REM
$SETE #FV1 RECCNT(RGNTYPE)
""
"         *******************************************************"
"         *****        R O I   D A T A   R E P O R T        *****"
"         *******************************************************"
""
""
"         Sample Title:   |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" STITLE
""
"         Elapsed Live time: |FFFFFFFF" ELIVE
"         Elapsed Real Time: |FFFFFFFF" EREAL
""
$IF #FV1
$REM
$REM INIT ROI COUNTER (IV6)
$REM
$SETE #IV6 1
$REM
$REM INITIALIZE LINE NUMBER COUNTER (FV9)
$REM
$SETE #FV9 49
$REM
$REM START LOOP FOR NUMBER OF ROI'S (RECCNT(RGNTYPE))
$REM
$BT RECCNT(RGNTYPE)
$REM
$REM INITIALIZE DATA CARRIERS (IV7, IV8, IV9, IV10, IV1, IV2, IV3, IV4)
$REM
$SETE #IV7 1
$SETE #IV8 1
$SETE #IV9 1
$SETE #IV10 1
$SETE #IV1 1
$SETE #IV2 1
$SETE #IV3 1
$SETE #IV4 1
$REM
$REM DO LOOP AS LONG AS THERE IS AN ROI (NOT ZERO)
$REM
$IF #FV1
$REM
$REM GET START (FV2) AND STOP (FV3) CHANNELS FOR CURRENT ROI AND CALCULATE #
$REM OF CHANNELS (FV4). NUMBER FOR LOOP WILL BE ROI CHANNELS DIVIDED BY THE
$REM NUMBER OF DATA POINTS (8) ACROSS THE PAGE (IV5).
$REM
$SETE #FV2 RGNSTART(#IV6,1)
$SETE #FV3 RGNEND(#IV6,1)
$SETE #FV4 #FV3
$SETS #FV4 #FV2
$SETA #FV4 1
$SETE #IV5 #FV4
$SETD #IV5 8
$REM
$REM SET DATA CARRIERS TO THE FIRST 8 CHANNELS OF THE ROI
$REM
$SETE #IV7 #FV2
$SETA #IV8 #IV7
$SETA #IV9 #IV8
$SETA #IV10 #IV9
$SETA #IV1 #IV10
$SETA #IV2 #IV1
$SETA #IV3 #IV2
$SETA #IV4 #IV3
$REM
$REM CHECK TO SEE IF WITHIN LAST 4 LINES OF PAGE. IF SO, PRINT APPROPRIATE
$REM NUMBER OF BLANK LINES TO GET TO END.
$REM
$REM FV9 KEEPS TRACK OF LINE NUMBERS FOR HEADER OF PAGE
$REM
$IF #FV9
$SETS #FV9 1
$IFNOT #FV9
""
$ENDIF
$ENDIF
$IF #FV9
$SETS #FV9 1
$IFNOT #FV9
""
""
$ENDIF
$ENDIF
$IF #FV9
$SETS #FV9 1
$IFNOT #FV9
""
""
""
$ENDIF
$ENDIF
$IF #FV9
$SETS #FV9 1
$IFNOT #FV9
""
""
""
""
$ENDIF
$ENDIF
$REM
$REM IF 5 LINES OR MORE FROM BOTTOM OF PAGE, WILL GET ROI HEADER AND AT
$REM LEAST ONE LINE OF THE ROI DATA.
$REM
$IF #FV9
""
"  ROI Number: |III  Channel |FFFFF to  |FFFFF" #IV6 #FV2 #FV3
""
"Channel|------|-------|-------|-------|-------|-------|-------|-------|"
$SETA #FV9 4
$SETS #FV9 1
$ENDIF
$REM
$REM NEXT SECTION TAKES CARE OF PRINTING HEADER AT TOP OF PAGE WHEN NUMBER
$REM OF LINES IS ZERO.
$REM
$IFNOT #FV9
""
""
"         Sample Title:   |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" STITLE
""
"  ROI Number: |III  Channel |FFFFF to  |FFFFF" #IV6 #FV2 #FV3
""
"Channel|------|-------|-------|-------|-------|-------|-------|-------|"
$SETE #FV9 54
$ENDIF
$SETS #FV9 3
$REM
$REM START LOOP FOR NUMBER OF CHANNELS DIVIDED BY 8 (IV5)
$REM
$IF #IV5
$BT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF"  #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10) SPECDATA(#IV1) SPECDATA(#IV2) SPECDATA(#IV3) SPECDATA(#IV4)
$SETS #FV9 1
$REM
$REM IF DURING ROI THE NUMBER OF LINES ZEROES OUT, PRINT THE FULL HEADER.
$REM
$IFNOT #FV9
""
""
"         Sample Title:   |AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" STITLE
""
"  ROI Number: |III  Channel |FFFFF to  |FFFFF" #IV6 #FV2 #FV3
""
"Channel|------|-------|-------|-------|-------|-------|-------|-------|"
$SETE #FV9 51
$ENDIF
$REM
$REM INCREMENT THE CHANNEL NUMBERS TO THE NEXT GROUP OF 8 CHANNELS.
$REM
$SETA #IV7 8
$SETA #IV8 8
$SETA #IV9 8
$SETA #IV10 8
$SETA #IV1 8
$SETA #IV2 8
$SETA #IV3 8
$SETA #IV4 8
$ET
$ENDIF
$REM
$REM DETERMINE NUMBER OF CHANNELS FOR LAST LINE AND PRINT IT OUT
$REM
$SETE #IV5 #IV4
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF" #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10) SPECDATA(#IV1) SPECDATA(#IV2) SPECDATA(#IV3) SPECDATA(#IV4)
$ENDIF
$SETE #IV5 #IV3
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10) SPECDATA(#IV1) SPECDATA(#IV2) SPECDATA(#IV3)
$ENDIF
$SETE #IV5 #IV2
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10) SPECDATA(#IV1) SPECDATA(#IV2)
$ENDIF
$SETE #IV5 #IV1
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10) SPECDATA(#IV1)
$ENDIF
$SETE #IV5 #IV10
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9) SPECDATA(#IV10)
$ENDIF
$SETE #IV5 #IV9
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8) SPECDATA(#IV9)
$ENDIF
$SETE #IV5 #IV8
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF |FFFFFF " #IV7 SPECDATA(#IV7) SPECDATA(#IV8)
$ENDIF
$SETE #IV5 #IV7
$SETS #IV5 #FV3
$IFNOT #IV5
"|FFFF: |FFFFFF " #IV7 SPECDATA(#IV7)
$ENDIF
$SETS #FV9 1
$REM
$REM DECREMENT THE ROI NUMBER (FV1) AND INCREMENT THE ROI COUNTER (IV6) AND
$REM END THE LOOP FOR THIS ROI
$REM
$SETS #FV1 1
$SETA #IV6 1
$ENDIF
$ET
$ENDIF
$REM
$REM IF NO ROIs IN DATASOURCE, COME HERE AND PRINT APPROPRIATE MESSAGE.
$REM
$IFNOT #IV6
""
"         *****            No ROI's in Datasource.          *****"
""
"         *******************************************************"
$ENDIF



